#!/usr/bin/env ruby
if ARGV.size == 0 || ARGV.include?('--help')
  puts "Usage: crocodile [options] source dest" 
  puts ""
  puts "  --start          Start the selenium server"
  puts "  --stop           Stop the selenium server"
  puts "  --width=WIDTH    Set the width of the window"
  puts "  --height=HEIGHT  Set the height of the window"
  puts "  --help"
  exit
end

# Grab the params
params = ARGV.reject{|arg| arg =~ /^--/}
dest = params[0] rescue nil
source = params[1] rescue nil

raise "You're not doing it right" if source.empty? || dest.empty?

require 'rubygems'
require 'crocodile'

width = ARGV.select{|arg| arg =~ /^--width=/}.first
width = width.gsub(/^--width=/, '') if width

height = ARGV.select{|arg| arg =~ /^--height=/}.first
height = height.gsub(/^--height=/, '') if height

puts "Starting Selenium"
options = {}
options[:start] = true if ARGV.include? '--start'
options[:stop] = true if ARGV.include? '--start'
options[:width] = width if width
options[:height] = height if height
Crocodile.snap("file://", File.expand_path(source), dest, options)

puts "Done"
